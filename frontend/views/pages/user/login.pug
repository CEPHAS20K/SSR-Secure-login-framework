extends ../../layouts/base

include ../../components/navbar
include ../../components/button
include ../../components/form-controls
include ../../components/ui-shells

block content
  +appNavbar(activePage || "login")
  #authView.relative.overflow-x-hidden.overflow-y-auto.bg-auth-svg.min-h-dvh
    .pointer-events-none.absolute.-left-28.-top-28.h-72.w-72.rounded-full.blur-3xl.hidden(
      class="bg-orange-200/45 sm:block"
    )
    .pointer-events-none.absolute.-right-24.h-80.w-80.rounded-full.blur-3xl.hidden(
      class="top-1/3 bg-orange-300/35"
    )

    .relative.z-10.mx-auto.flex.w-full.max-w-3xl.items-start.justify-center.px-4.pt-24.pb-6(
      class="min-h-[calc(100dvh-6rem)] sm:items-center sm:min-h-[calc(100dvh-7rem)] sm:pt-28 sm:pb-8 md:px-6"
    )
      +authGlassCard("loginCard", "max-w-md p-5 mx-auto sm:rounded-3xl sm:p-7 md:p-8")
        +authSectionTitle("Sign in", "Enter your details to continue.", "loginTitle", "mb-6 text-center", "font-headline leading-none text-rose-900 tracking-wide text-3xl sm:text-5xl", "mt-2 text-sm font-semibold text-rose-800", "font-family: 'Finger Paint', cursive")

        #loginFormShell.auth-form-shell.auth-form-loading
          .auth-form-skeleton(aria-hidden="true")
            .auth-skeleton-line.w-24
            .auth-skeleton-block.h-11
            .auth-skeleton-line.w-24.mt-2
            .auth-skeleton-block.h-11
            .auth-skeleton-line.w-28.mt-2
            .auth-skeleton-block.h-10
            .auth-skeleton-block.h-11.mt-1
          form#loginForm.grid.gap-3(action="/auth/login", method="POST")
            +authFieldShell("email", "Email", "login-field space-y-2")
              input#email.w-full.rounded-xl.border.border-rose-200.px-4.py-3.text-sm.font-semibold.text-rose-950.outline-none.transition(
                type="email",
                name="email",
                autocomplete="email",
                placeholder="you@example.com",
                required,
                class="bg-white/60 placeholder:text-rose-300 focus:border-primary focus:ring-2 focus:ring-primary/20"
              )

            +authFieldShell("password", "", "login-field space-y-2")
              .flex.items-center.justify-between
                label.block.text-sm.font-semibold.text-rose-900(for="password") Password
                a#forgotPasswordLink.text-xs.font-bold.text-fuchsia-800.transition(
                  href="#",
                  class="hover:text-fuchsia-950"
                ) Forgot?
              .relative
                input#password.w-full.rounded-xl.border.border-rose-200.px-4.py-3.pr-16.text-sm.font-semibold.text-rose-950.outline-none.transition(
                  type="password",
                  name="password",
                  autocomplete="current-password",
                  aria-describedby="capsWarning",
                  placeholder="••••••••",
                  required,
                  class="bg-white/60 placeholder:text-rose-300 focus:border-primary focus:ring-2 focus:ring-primary/20"
                )
                button#togglePassword.absolute.right-3.rounded-md.px-2.py-1.text-xs.font-semibold.text-fuchsia-700.transition(
                  type="button",
                  class="top-1/2 -translate-y-1/2 hover:bg-fuchsia-100 hover:text-fuchsia-900"
                ) Show
              p#capsWarning.invisible.text-xs.font-semibold.text-rose-900(
                aria-live="polite",
                aria-hidden="true"
              ) Caps Lock is on

            #trustRow.login-field.grid.grid-cols-1.gap-2.-mt-1(class="sm:grid-cols-2")
              label.flex.items-center.justify-center.gap-2.rounded-lg.px-2.py-2.text-xs.font-bold.text-rose-900(
                class="bg-white/35"
              )
                input#rememberMe.h-4.w-4.rounded.border-rose-300(
                  type="checkbox",
                  name="rememberMe"
                )
                | Remember me
              label.flex.items-center.justify-center.gap-2.rounded-lg.px-2.py-2.text-xs.font-bold.text-rose-900(
                class="bg-white/35"
              )
                input#trustDevice.h-4.w-4.rounded.border-rose-300(
                  type="checkbox",
                  name="trustDevice"
                )
                | Trust device

            .login-field.flex.justify-center
              +appButton("Login", "primary", "submit")#loginBtn.py-3.px-8.min-w-36(disabled)

  +authModalShell("otpModal")
    +authModalHeader("Enter OTP", "Check your device for the code.", "otpClose")
    input#otpInput.mt-4.w-full.rounded-xl.border.border-rose-200.px-3.text-rose-950(
      type="text",
      autocomplete="one-time-code",
      inputmode="numeric",
      maxlength="5",
      placeholder="65497",
      class="bg-white/60 py-2.5 placeholder:text-rose-300 focus:border-primary focus:ring-2 focus:ring-primary/20"
    )
    .mt-5.flex.flex-col.gap-3(class="sm:flex-row sm:items-center sm:justify-between")
      +appButton("Submit", "primary", "button")#otpSubmit.flex-1(disabled)
      +appButton("Resend (05:00)", "ghost", "button")#resendOtp.flex-1

  +authModalShell("resetModal", "fixed inset-0 hidden items-center justify-center p-3 backdrop-blur-sm z-[81] bg-rose-950/55 sm:p-4", "otp-card w-full max-w-md rounded-2xl border bg-white p-4 shadow-2xl backdrop-blur-2xl font-semibold border-white/40 bg-white/25")
    +authModalHeader("Reset Account", "Update your email and create a new password.", "resetClose", "text-lg leading-none text-rose-900", "Close")
    .mt-4.space-y-3
      div(class="space-y-1.5")
        label.block.text-xs.font-bold.uppercase.tracking-wide.text-rose-900(for="resetEmail") Email
        input#resetEmail.w-full.rounded-xl.border.border-rose-200.px-3.text-sm.font-semibold.text-rose-950(
          type="email",
          autocomplete="email",
          placeholder="you@example.com",
          class="py-2.5 bg-white/60 placeholder:text-rose-300 focus:border-primary focus:ring-2 focus:ring-primary/20"
        )
      div(class="space-y-1.5")
        label.block.text-xs.font-bold.uppercase.tracking-wide.text-rose-900(for="resetNewPassword")
          | New Password
        input#resetNewPassword.w-full.rounded-xl.border.border-rose-200.px-3.text-sm.font-semibold.text-rose-950(
          type="password",
          autocomplete="new-password",
          placeholder="Minimum 8 characters",
          class="py-2.5 bg-white/60 placeholder:text-rose-300 focus:border-primary focus:ring-2 focus:ring-primary/20"
        )
      div(class="space-y-1.5")
        label.block.text-xs.font-bold.uppercase.tracking-wide.text-rose-900(
          for="resetConfirmPassword"
        ) Confirm Password
        input#resetConfirmPassword.w-full.rounded-xl.border.border-rose-200.px-3.text-sm.font-semibold.text-rose-950(
          type="password",
          autocomplete="new-password",
          placeholder="Repeat new password",
          class="py-2.5 bg-white/60 placeholder:text-rose-300 focus:border-primary focus:ring-2 focus:ring-primary/20"
        )
    .mt-4.flex.flex-col.gap-3(class="sm:flex-row sm:items-center sm:justify-between")
      +appButton("Submit Reset", "primary", "button")#resetSubmit.flex-1(disabled)
      +appButton("Cancel", "ghost", "button")#resetCancel.flex-1
  script(src=assetPath("/js/pages/login.js"), type="module")
