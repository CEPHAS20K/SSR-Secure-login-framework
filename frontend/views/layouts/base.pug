doctype html
html(lang="en")
  -
    const currentPage = typeof page === "string" ? page : "";
    const gsapPages = new Set(["landing", "admin-dashboard", "error"]);
    const shouldLoadGsap = gsapPages.has(currentPage);
    const shouldPreloadLandingVisuals = currentPage === "landing";
    const preloadFontHrefs = ["/fonts/inter-latin-400.woff2"];

    if (currentPage === "landing") {
      preloadFontHrefs.push("/fonts/cabin-sketch-latin-700.woff2", "/fonts/schoolbell-latin-400.woff2");
    } else if (currentPage === "login" || currentPage === "register" || currentPage === "admin-login") {
      preloadFontHrefs.push("/fonts/finger-paint-latin-400.woff2", "/fonts/schoolbell-latin-400.woff2");
    } else if (currentPage === "admin-dashboard") {
      preloadFontHrefs.push("/fonts/bebas-neue-latin-400.woff2");
    }
  head
    meta(charset="UTF-8")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    meta(name="theme-color", content="#ff7700")
    meta(name="mobile-web-app-capable", content="yes")
    meta(name="apple-mobile-web-app-status-bar-style", content="black-translucent")
    meta(name="apple-mobile-web-app-title", content="Secure Storage Vault")
    title Secure Storage Vault
    link(rel="icon", type="image/png", sizes="32x32", href=assetPath("/images/favicon-32.png"))
    link(rel="icon", type="image/png", sizes="16x16", href=assetPath("/images/favicon-16.png"))
    link(rel="apple-touch-icon", sizes="192x192", href=assetPath("/images/icon-192.png"))
    link(rel="manifest", href=assetPath("/manifest.webmanifest"))
    if shouldPreloadLandingVisuals
      link(
        rel="preload",
        as="image",
        href=assetPath("/images/land.svg"),
        type="image/svg+xml",
        fetchpriority="high"
      )
    each fontHref in preloadFontHrefs
      link(rel="preload", as="font", type="font/woff2", href=fontHref, crossorigin="anonymous")
    script.
      window.__assetVersion = "#{assetVersion}";
    link(rel="stylesheet", href=assetPath("/css/fonts.css"))
    link(rel="stylesheet", href=assetPath("/vendor/notyf.min.css"))
    link(rel="preload", as="style", href=assetPath("/css/critical.css"))
    link(
      rel="stylesheet",
      href=assetPath("/css/critical.css"),
      media="print",
      onload="this.media='all'"
    )
    style.
      html,
      body {
        background: #ff7700;
      }
    link(rel="stylesheet", href=assetPath("/css/output.css"))
  body.min-h-screen.bg-slate-100.font-body.text-slate-900(data-page=page || "")
    #appToastRegion.pointer-events-none.fixed.inset-x-0.top-16.mx-auto.flex.w-full.max-w-md.flex-col.gap-2.px-3(
      class="z-[90]",
      aria-live="polite",
      aria-atomic="false"
    )
    script(src=assetPath("/vendor/notyf.min.js"))
    main
      block content
    if shouldLoadGsap
      script(src=assetPath("/vendor/gsap.min.js"), defer)
    if rumEnabled
      script(src=assetPath("/js/web-vitals-rum.js"), type="module")
    script(src=assetPath("/js/animations/navbar.js"), defer)
    script(src=assetPath("/js/animations.js"), defer)
    script(src=assetPath("/js/link-prefetch.js"), defer)
    script(src=assetPath("/js/sw-register.js"), defer)
    script(src=assetPath("/js/pwa-install-prompt.js"), defer)
