extends ./layouts/base

include ./components/navbar
include ./components/button
include ./components/form-controls

block content
  +appNavbar(activePage || "register")
  #authView.relative.overflow-hidden.bg-auth-svg.min-h-dvh
    canvas#registerParticles.pointer-events-none.absolute.inset-0.z-0(data-auth-particles)
    .pointer-events-none.absolute.-left-24.top-8.hidden.h-56.w-56.rounded-full.blur-3xl(
      class="bg-fuchsia-200/30 sm:block"
    )
    .pointer-events-none.absolute.-right-20.bottom-10.hidden.h-64.w-64.rounded-full.blur-3xl(
      class="bg-rose-200/35 sm:block"
    )

    .mx-auto.flex.w-full.max-w-4xl.items-center.justify-center.px-4.pt-24.pb-6(
      class="min-h-[calc(100dvh-6rem)] sm:min-h-[calc(100dvh-7rem)] sm:pt-28 sm:pb-8 md:px-6"
    )
      section#registerCard.w-full.max-w-2xl.rounded-2xl.border.p-5.text-rose-950.shadow-2xl.backdrop-blur-2xl(
        class="border-white/45 bg-white/30 sm:rounded-3xl sm:p-7"
      )
        .mb-6.text-center.space-y-2
          h1#registerTitle.font-headline.leading-none.text-rose-900.tracking-wide.text-3xl(
            class="sm:text-5xl",
            style="font-family: 'Finger Paint', cursive"
          )
            | Register

        #registerFormShell.auth-form-shell.auth-form-loading
          .auth-form-skeleton(aria-hidden="true")
            .auth-skeleton-line.w-28
            .grid.grid-cols-2.gap-3.mt-2
              .auth-skeleton-block.h-11
              .auth-skeleton-block.h-11
            .grid.grid-cols-2.gap-3.mt-2
              .auth-skeleton-block.h-11
              .auth-skeleton-block.h-11
            .auth-skeleton-block.h-11.mt-2
            .auth-skeleton-block.h-11.mt-2
          form#registerForm.grid.gap-4(action="/auth/register", method="POST", class="md:grid-cols-2")
            +authFieldShell("username", "Username", "register-field space-y-1.5", "block text-xs font-bold uppercase tracking-wide text-rose-800")
              input#username.w-full.rounded-xl.border.px-3.border-rose-200.text-rose-950(
                type="text",
                name="username",
                autocomplete="username",
                placeholder="Enter username",
                required,
                class="py-2.5 bg-white/70 focus:border-primary focus:ring-2 focus:ring-primary"
              )

            +authFieldShell("regEmail", "Email", "register-field space-y-1.5", "block text-xs font-bold uppercase tracking-wide text-rose-800")
              input#regEmail.w-full.rounded-xl.border.px-3.border-rose-200.text-rose-950(
                type="email",
                name="email",
                autocomplete="email",
                placeholder="you@example.com",
                required,
                class="py-2.5 bg-white/70 focus:border-primary focus:ring-2 focus:ring-primary"
              )

            .register-field(class="space-y-1.5")
              label.block.text-xs.font-bold.uppercase.tracking-wide.text-rose-800(
                for="regPassword"
              ) Password
              .relative
                input#regPassword.w-full.rounded-xl.border.px-3.pr-12.border-rose-200.text-rose-950(
                  type="password",
                  name="password",
                  autocomplete="new-password",
                  placeholder="Min 8 chars",
                  required,
                  class="py-2.5 bg-white/70 focus:border-primary focus:ring-2 focus:ring-primary"
                )
                button#toggleRegPassword.absolute.right-2.rounded-md.px-2.py-1.text-xs.font-bold.text-rose-700.transition(
                  type="button",
                  class="top-1/2 -translate-y-1/2 hover:bg-fuchsia-100"
                ) Show

            .register-field(class="space-y-1.5")
              label.block.text-xs.font-bold.uppercase.tracking-wide.text-rose-800(
                for="regPasswordConfirm"
              ) Confirm
              .relative
                input#regPasswordConfirm.w-full.rounded-xl.border.px-3.pr-12.border-rose-200.text-rose-950(
                  type="password",
                  name="confirmPassword",
                  autocomplete="new-password",
                  placeholder="Repeat pwd",
                  required,
                  class="py-2.5 bg-white/70 focus:border-primary focus:ring-2 focus:ring-primary"
                )
                button#toggleRegPasswordConfirm.absolute.right-2.rounded-md.px-2.py-1.text-xs.font-bold.text-rose-700.transition(
                  type="button",
                  class="top-1/2 -translate-y-1/2 hover:bg-fuchsia-100"
                ) Show

            p#passwordMismatch.hidden.text-xs.font-semibold.text-rose-700(class="md:col-span-2") Passwords do not match.

            .register-field(class="space-y-1.5")
              label.block.text-xs.font-bold.uppercase.tracking-wide.text-rose-800(for="gender") Gender
              select#gender.w-full.rounded-xl.border.px-3.border-rose-200.text-rose-950(
                name="gender",
                autocomplete="sex",
                required,
                class="py-2.5 bg-white/70 focus:border-primary focus:ring-2 focus:ring-primary"
              )
                option(value="") Select Gender
                option(value="male") Male
                option(value="female") Female

            .register-field.flex.items-start.gap-2.rounded-lg.p-3(class="bg-white/55 md:col-span-2")
              input#agreeTerms.h-4.w-4.rounded.border-rose-300(type="checkbox", class="mt-0.5")
              label.text-xs.font-semibold.text-rose-800(for="agreeTerms")
                | I agree to the terms and privacy policy.

            +authStatusMessage("registerFlash", "md:col-span-2 min-h-5 text-sm font-semibold", "polite")

            +appButton("Register", "primary", "submit")#registerBtn.register-field.w-full.py-3(
              class="md:col-span-2",
              disabled
            )

  +authModalShell("registerOtpModal")
    .mb-2.flex.items-start.justify-between
      .pr-3
        h3.text-lg.font-black.text-rose-900 Verify Email OTP
        p.mt-1.text-sm.font-semibold.text-rose-800 Enter the 5-digit code sent to your email.
      button#registerOtpClose.rounded-md.px-2.py-1.text-xs.font-bold.text-fuchsia-900.transition(
        type="button",
        class="hover:bg-fuchsia-100"
      ) Close
    input#registerOtpInput.mt-4.w-full.rounded-xl.border.border-rose-200.px-3.text-rose-950(
      type="text",
      autocomplete="one-time-code",
      inputmode="numeric",
      maxlength="5",
      placeholder="12345",
      class="bg-white/60 py-2.5 placeholder:text-rose-300 focus:border-primary focus:ring-2 focus:ring-primary/20"
    )
    .mt-5.flex.flex-col.gap-3(class="sm:flex-row sm:items-center sm:justify-between")
      +appButton("Submit", "primary", "button")#registerOtpSubmit.flex-1(disabled)
      +appButton("Resend (05:00)", "ghost", "button")#registerResendOtp.flex-1(disabled)

  script(src=assetPath("/js/animations/login-particles.js"), defer)
  script(src=assetPath("/js/pages/register.js"), type="module")
